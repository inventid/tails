!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Tails=e()}}(function(){return function e(t,n,r){function u(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var s=n[o]={exports:{}};t[o][0].call(s.exports,function(e){var n=t[o][1][e];return u(n?n:e)},s,s.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)u(r[o]);return u}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var n=[],r=!0,u=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){u=!0,i=l}finally{try{!r&&a["return"]&&a["return"]()}finally{if(u)throw i}}return n}throw new TypeError("Invalid attempt to destructure non-iterable instance")}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},c=e("../node_modules/sonic/dist/linked_list"),s=r(c),f=e("../node_modules/knuckles/dist/simple_record"),v=r(f),y=function(e){function t(e){i(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.constructor.all().push(this)}return o(t,e),a(t,null,[{key:"_keyFn",value:function(e){return e.id||null}},{key:"all",value:function(){return null==this._collection&&(this._collection=new s["default"]([],this._keyFn)),this._collection}},{key:"where",value:function(e,n,r){return t.pluck(e,n).filter(function(e){var t=u(e,2),n=(t[0],t[1]);return n===r}).map(function(e){return e[0]})}},{key:"pluck",value:function(e,t){return e.flatMap(function(e){return e.zoom(t).map(function(t){return[e,t]})})}}]),t}(v["default"]);y.belongsTo=function(e){},n["default"]=y,t.exports=n["default"]},{"../node_modules/knuckles/dist/simple_record":6,"../node_modules/sonic/dist/linked_list":28}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var u,i=e("./model"),o=r(i);!function(e){e.Model=o["default"]}(u||(u={})),t.exports=u},{"./model":1}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./observable_record"),l=e("../node_modules/sonic/dist/mutable_list"),c=function(e){function t(e){r(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),null!=e&&(this.set=e.set,this["delete"]=e["delete"])}return u(t,e),i(t,[{key:"set",value:function(e,t){throw new Error("Not implemented")}},{key:"delete",value:function(e){throw new Error("Not implemented")}},{key:"zoom",value:function(e){return l.MutableList.create(t.zoom(this,e))}}],[{key:"create",value:function(e){return new t(e)}},{key:"zoom",value:function(e,t){function n(n,r){n==t&&e.set(t,r)}function r(n,r){for(var u=arguments.length,i=Array(u>2?u-2:0),o=2;u>o;o++)i[o-2]=arguments[o];i.length?e.set(t,i[0]):e["delete"](t)}var u=a.ObservableRecord.zoom(e,t);return l.MutableList.create({has:u.has,get:u.get,prev:u.prev,next:u.next,observe:u.observe,set:n,splice:r})}}]),t}(a.ObservableRecord);n.MutableRecord=c,n["default"]=c},{"../node_modules/sonic/dist/mutable_list":15,"./observable_record":4}],4:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},l=e("../node_modules/sonic/dist/unit"),c=r(l),s=e("./record"),f=e("../node_modules/sonic/dist/observable_list"),v=function(e){function t(e){u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),null!=e&&(this.observe=e.observe)}return i(t,e),o(t,[{key:"observe",value:function(e){throw new Error("Not implemented")}},{key:"zoom",value:function(e){return f.ObservableList.create(t.zoom(this,e))}}],[{key:"create",value:function(e){return new t(e)}},{key:"zoom",value:function(e,t){var n=new c["default"];return e.get(t).then(function(e){return n.set(t,e)}),e.observe({onInvalidate:function(r){r==t&&e.get(t).then(function(e){return n.set(t,e)})["catch"](function(){return n.splice(null,null)})}}),f.ObservableList.create(n)}}]),t}(s.Record);n.ObservableRecord=v,n["default"]=v},{"../node_modules/sonic/dist/observable_list":20,"../node_modules/sonic/dist/unit":22,"./record":5}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=e("../node_modules/sonic/dist/list"),o=e("../node_modules/sonic/dist/factory"),a=function(){function e(t){r(this,e),null!=t&&(this.get=t.get,this.has=t.has)}return u(e,[{key:"has",value:function(e){throw new Error("Not implemented")}},{key:"get",value:function(e){throw new Error("Not implemented")}},{key:"zoom",value:function(t){return i.List.create(e.zoom(this,t))}}],[{key:"create",value:function(t){return new e(t)}},{key:"zoom",value:function(e,t){var n=o.fromPromise(e.get(t));return{has:n.has,get:n.get,prev:n.prev,next:n.next}}}]),e}();n.Record=a,n["default"]=a},{"../node_modules/sonic/dist/factory":10,"../node_modules/sonic/dist/list":14}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./mutable_record"),l=e("../node_modules/sonic/dist/observable"),c=function(e){function t(e){r(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._object=e,this._subject=new l.Subject}return u(t,e),i(t,[{key:"has",value:function(e){var t=this;return new Promise(function(n,r){n(e in t._object)})}},{key:"get",value:function(e){var t=this;return new Promise(function(n,r){e in t._object?n(t._object[e]):r()})}},{key:"observe",value:function(e){return this._subject.observe(e)}},{key:"set",value:function(e,t){var n=this;return new Promise(function(r,u){n._object[e]=t,n._subject.notify(function(t){t.onInvalidate(e)}),r(e)})}},{key:"delete",value:function(e){var t=this;return new Promise(function(n,r){e in t._object||r();var u=t._object[e];delete t._object[e],t._subject.notify(function(t){t.onInvalidate(e)}),n(u)})}}]),t}(a.MutableRecord);n.SimpleRecord=c,n["default"]=c},{"../node_modules/sonic/dist/observable":16,"./mutable_record":3}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var i=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},o=e("./observable"),a=e("./mutable_list"),l=function(e){function t(){var e=this,n=void 0===arguments[0]?[]:arguments[0];r(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.has=function(t){return null!=t&&t>-1&&t<e._array.length},this.get=function(t){return e.has(t)?e._array[t]:void 0},this.prev=function(t){return null==t&&e._array.length?e._array.length-1:e._array.length>0&&null!=t&&e.has(t)&&e.has(t-1)?t-1:null},this.next=function(t){return null==t&&e._array.length?0:e._array.length>0&&null!=t&&e.has(t)&&e.has(t+1)?t+1:null},this.set=function(t,n){return e.has(t)?(e._array[t]=n,t):null},this.splice=function(t,n){for(var r=arguments.length,u=Array(r>2?r-2:0),i=2;r>i;i++)u[i-2]=arguments[i];var o;if(null==t)t=-1;else if(!e.has(t))return;if(null==n)n=e._array.length;else if(!e.has(n))return;(o=e._array).splice.apply(o,[t+1,n-(t+1)].concat(u)),e._invalidate(t,null)},this.observe=function(t){return e._subject.observe(t)},this._invalidate=function(t,n){e.has(t)||(t=null),e.has(n)||(n=null),e._subject.notify(function(e){e.onInvalidate(t,n)})},this._subject=new o.Subject,this._array=n}return u(t,e),t}(a.MutableList);n["default"]=l,t.exports=n["default"]},{"./mutable_list":15,"./observable":16}],8:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n){var u=this;r(this,e),this.has=function(e){return new Promise(function(t,n){u._scheduler(function(){Promise.resolve(u._list.has(e)).then(t)["catch"](n)})})},this.get=function(e){return new Promise(function(t,n){u.has(e).then(function(r){return r?t(u._list.get(e)):n()})["catch"](n)})},this.prev=function(e){return new Promise(function(t,n){u._scheduler(function(){Promise.resolve(u._list.prev(e)).then(function(e){return null!=e?t(e):n()})["catch"](n)})})},this.next=function(e){return new Promise(function(t,n){u._scheduler(function(){Promise.resolve(u._list.next(e)).then(function(e){return null!=e?t(e):n()})["catch"](n)})})},this._list=t,this._scheduler=n||window.setTimeout}return u(e,null,[{key:"create",value:function(t){return new e(t)}},{key:"map",value:function(t,n){function r(e){return t.get(e).then(n)}var u=t.has,i=t.prev,o=t.next;return new e({has:u,get:r,prev:i,next:o})}}]),e}();n.AsyncList=i,n["default"]=i},{}],9:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function i(e){var t=this;r(this,i),this.has=function(e){return e in t._byKey||t._list.has(e)},this.get=function(e){return e in t._byKey?t._byKey[e]:t._list.has(e)?t._byKey[e]=t._list.get(e):void 0},this.prev=function(e){if(e in t._prev)return t._prev[e];var n=t._list.prev(e);return null==n&&(n=null),t._prev[e]=n,t._next[n]=e,n},this.next=function(){var e=void 0===arguments[0]?null:arguments[0];if(e in t._next)return t._next[e];var n=t._list.next(e);return null==n&&(n=null),t._next[e]=n,t._prev[n]=e,n},this._byKey=Object.create(null),this._next=Object.create(null),this._prev=Object.create(null),this._list=e};n.Cache=u,n["default"]=u},{}],10:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){return c.MutableList.isMutableList(e)?c.MutableList.create(e):l.ObservableList.isObservableList(e)?l.ObservableList.create(e):a.List.isList(e)?a.List.create(e):Array.isArray(e)?new y["default"](e):f["default"].create(e)}function i(e){var t=new f["default"];return e.then(function(e){t.push(e)}),l.ObservableList.create(t)}function o(e){var t={has:function(e){return null},get:function(e){return null},prev:function(e){return null},next:function(e){return null}};return t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=u,n.fromPromise=i,n.fromIterator=o;var a=e("./list"),l=e("./observable_list"),c=e("./mutable_list"),s=e("./unit"),f=r(s),v=e("./array_list"),y=r(v)},{"./array_list":7,"./list":14,"./mutable_list":15,"./observable_list":20,"./unit":22}],11:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function i(e){var t=this;r(this,i),this.has=function(e){if(e>=0&&e<t._byIndex.length)return!0;for(var n,r=t._byIndex.length-1;r!=e;){if(n=t._list.next(t._byIndex[r]),null==n)return!1;t._byIndex[++r]=n}return!0},this.get=function(e){return t.has(e)?t._list.get(t._byIndex[e]):void 0},this.prev=function(e){return t.has(e-1)?e-1:null==e&&t._byIndex.length?t._byIndex.length-1:null},this.next=function(){var e=void 0===arguments[0]?-1:arguments[0];return t.has(e+1)?e+1:null},this._byIndex=[],this._list=e};n.Index=u,n["default"]=u},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;!function(e){function t(e){return e.toString()}function n(){return r++}var r=0;e.key=t,e.create=n}(r||(r={})),n["default"]=r,t.exports=n["default"]},{}],13:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function i(e,t){var n=this;r(this,i),this.has=function(e){if(e in n._sourceKeyByKey)return!0;for(var t=null;null!=(t=n.next(t));)if(t==e)return!0;return!1},this.get=function(e){return n.has(e)?n._list.get(n._sourceKeyByKey[e]):void 0},this.prev=function(e){return n.has(e)||null==e?n._keyBySourceKey[n._list.prev(n._sourceKeyByKey[e])]:void 0},this.next=function(){var e,t,r=void 0===arguments[0]?null:arguments[0];e=r in n._sourceKeyByKey?n._sourceKeyByKey[r]:null;for(;null!=r&&!(r in n._sourceKeyByKey);)if(e=n._list.next(e),!(e in n._keyBySourceKey)){if(null==e)return null;if(t=n._keyFn(n._list.get(e),e),n._keyBySourceKey[e]=t,n._sourceKeyByKey[t]=e,t==r)break}return e=n._list.next(e),null==e?null:(t=n._keyFn(n._list.get(e),e),n._keyBySourceKey[e]=t,n._sourceKeyByKey[t]=e,t)},this._list=e,this._keyFn=t,this._sourceKeyByKey=Object.create(null),this._keyBySourceKey=Object.create(null)};n.KeyBy=u,n["default"]=u},{}],14:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./tree"),a=e("./cache"),l=r(a),c=e("./index"),s=r(c),f=e("./key_by"),v=r(f),y=e("./async_list"),h=function(){function e(t){var n=this;u(this,e),this.has=function(e){throw new Error("Not implemented")},this.get=function(e){throw new Error("Not implemented")},this.prev=function(e){throw new Error("Not implemented")},this.next=function(e){throw new Error("Not implemented")},this.first=function(){return e.first(n)},this.last=function(){return e.last(n)},this.forEach=function(t){return e.forEach(n,t)},this.reduce=function(t,r){return e.reduce(n,t)},this.toArray=function(){return e.toArray(n)},this.findKey=function(t){return e.findKey(n,t)},this.find=function(t){return e.find(n,t)},this.keyOf=function(t){return e.keyOf(n,t)},this.indexOf=function(t){return e.indexOf(n,t)},this.keyAt=function(t){return e.keyAt(n,t)},this.at=function(t){return e.at(n,t)},this.every=function(t){return e.every(n,t)},this.some=function(t){return e.some(n,t)},this.contains=function(t){return e.contains(n,t)},this.reverse=function(){return e.create(e.reverse(n))},this.map=function(t){return e.create(e.map(n,t))},this.filter=function(t){return e.create(e.filter(n,t))},this.flatten=function(){return e.create(e.flatten(n))},this.flatMap=function(t){return e.create(e.flatMap(n,t))},this.cache=function(){return e.create(e.cache(n))},this.index=function(){return e.create(e.index(n))},this.keyBy=function(t){return e.create(e.keyBy(n,t))},this.zip=function(t,r){return e.create(e.zip(n,t,r))},this.skip=function(t){return e.create(e.skip(n,t))},this.take=function(t){return e.create(e.take(n,t))},this.range=function(t,r){return e.create(e.range(n,t,r))},this.scan=function(t,r){return e.create(e.scan(n,t,r))},null!=t&&(this.has=t.has,this.get=t.get,this.prev=t.prev,this.next=t.next)}return i(e,null,[{key:"isList",value:function(e){return!!(null!=e&&e.has&&e.get&&e.prev&&e.next)}},{key:"create",value:function(t){return new e({has:t.has,get:t.get,prev:t.prev,next:t.next})}},{key:"first",value:function(e){return e.get(e.next())}},{key:"last",value:function(e){return e.get(e.prev())}},{key:"forEach",value:function(e,t){for(var n;null!=(n=e.next(n));)t(e.get(n),n)}},{key:"reduce",value:function(e,t,n){for(var r;null!=(r=e.next(r));)n=t(n,e.get(r),r);return n}},{key:"toArray",value:function(e){for(var t,n=0,r=[];null!=(t=e.next(t));)r[n++]=e.get(t);return r}},{key:"findKey",value:function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return n}},{key:"find",value:function(t,n){return t.get(e.findKey(t,n))}},{key:"keyOf",value:function(t,n){return e.findKey(t,function(e){return e===n})}},{key:"indexOf",value:function(e,t){for(var n,r=0;null!=(n=e.next(n));){if(e.get(n)===t)return r;r++}}},{key:"keyAt",value:function(e,t){for(var n,r=0;null!=(n=e.next(n));)if(r++==t)return n;return null}},{key:"at",value:function(t,n){return t.get(e.keyAt(t,n))}},{key:"every",value:function(e,t){for(var n;null!=(n=e.next(n));)if(!t(e.get(n),n))return!1;return!0}},{key:"some",value:function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return!0;return!1}},{key:"contains",value:function(t,n){return e.some(t,function(e){return e===n})}},{key:"reverse",value:function(e){function t(t){return e.next(t)}function n(t){return e.prev(t)}var r=e.has,u=e.get;return{has:r,get:u,prev:t,next:n}}},{key:"map",value:function(e,t){function n(n){return r(n)?t(e.get(n),n):void 0}var r=e.has,u=e.prev,i=e.next;return{has:r,get:n,prev:u,next:i}}},{key:"filter",value:function(e,t){function n(n){return e.has(n)&&t(e.get(n),n)}function r(t){return n(t)?e.get(t):void 0}function u(t){for(var r=t;null!=(r=e.prev(r));)if(n(r))return r;return null}function i(t){for(var r=t;null!=(r=e.next(r));)if(n(r))return r;return null}return{has:n,get:r,prev:u,next:i}}},{key:"flatten",value:function(e){function t(t){var n=o.Path.create(t);return o.Tree.has(e,n,1)}function n(t){var n=o.Path.create(t);return o.Tree.get(e,n,1)}function r(t){var n=o.Path.create(t);return o.Path.key(o.Tree.prev(e,n,1))}function u(t){var n=o.Path.create(t);return o.Path.key(o.Tree.next(e,n,1))}return{has:t,get:n,prev:r,next:u}}},{key:"flatMap",value:function(t,n){return e.flatten(e.map(t,n))}},{key:"cache",value:function(e){return new l["default"](e)}},{key:"index",value:function(e){return new s["default"](e)}},{key:"keyBy",value:function(e,t){return new v["default"](e,t)}},{key:"zip",value:function(t,n,r){function u(e){return t.has(e)&&n.has(e)}function i(e){return u(e)?r(t.get(e),n.get(e)):void 0}function o(e){var r=t.prev(e);return null!=r&&r==n.prev(e)?r:null}function a(e){var r=t.next(e);return null!=r&&r==n.next(e)?r:null}return t=e.index(t),n=e.index(n),{has:u,get:i,prev:o,next:a}}},{key:"skip",value:function(t,n){return e.filter(e.index(t),function(e,t){return t>=n})}},{key:"take",value:function(t,n){return e.filter(e.index(t),function(e,t){return n>t})}},{key:"range",value:function(t,n,r){return e.filter(e.index(t),function(e,t){return t>=n&&r+n>t})}},{key:"scan",value:function(t,n,r){function u(e){var u=i.prev(e);return n(null!=u?i.get(u):r,t.get(e))}var i,o=t.has,a=t.prev,l=t.next;return i=e.cache({has:o,get:u,prev:a,next:l})}},{key:"async",value:function(e,t){return new y.AsyncList(e)}}]),e}();n.List=h,n["default"]=h},{"./async_list":8,"./cache":9,"./index":11,"./key_by":13,"./tree":21}],15:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},l=e("./observable_list"),c=function(e){function t(e){var n=this;u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.set=function(e,t){throw new Error("Not implemented")},this.splice=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),u=2;n>u;u++)r[u-2]=arguments[u];throw new Error("Not implemented")},this.addBefore=function(e,r){return t.addBefore(n,e,r)},this.addAfter=function(e,r){return t.addAfter(n,e,r)},this.push=function(e){return t.push(n,e)},this.unshift=function(e){return t.unshift(n,e)},this["delete"]=function(e){return t["delete"](n,e)},this.deleteBefore=function(e){return t.deleteBefore(n,e)},this.deleteAfter=function(e){return t.deleteAfter(n,e)},this.pop=function(){return t.pop(n)},this.shift=function(){return t.shift(n)},this.remove=function(e){return t.remove(n,e)},this.compose=function(e){return t.create(t.compose(n,e))},null!=e&&(this.set=e.set,this.splice=e.splice)}return i(t,e),o(t,null,[{key:"isMutableList",value:function(e){return l.ObservableList.isObservableList(e)&&!!e.set&&!!e.splice}},{key:"create",value:function(e){return new t({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe,set:e.set,splice:e.splice})}},{key:"addBefore",value:function(e,t,n){return e.splice(e.prev(t),t,n),e.prev(t)}},{key:"addAfter",value:function(e,t,n){return e.splice(t,e.next(t),n),e.next(t)}},{key:"push",value:function(e,n){return t.addBefore(e,null,n)}},{key:"unshift",value:function(e,n){return t.addAfter(e,null,n)}},{key:"delete",value:function(e,t){if(e.has(t)){var n=e.get(t);return e.splice(e.prev(t),e.next(t)),n}}},{key:"deleteBefore",value:function(e,n){return t["delete"](e,e.prev(n))}},{key:"deleteAfter",value:function(e,n){return t["delete"](e,e.next(n))}},{key:"pop",value:function(e){return t.deleteBefore(e,null)}},{key:"shift",value:function(e){return t.deleteAfter(e,null)}},{key:"remove",value:function(e,n){var r=t.keyOf(e,n);return null==r?!1:(delete r,!0)}},{key:"compose",value:function(e,t){function n(n){return t.get(e.get(n))}function u(n,r){e.set(n,t.set(e.get(n),r))}function i(n,u){for(var i=arguments.length,o=Array(i>2?i-2:0),a=2;i>a;a++)o[a-2]=arguments[a];e.splice.apply(e,[n,u].concat(r(o.map(function(e){return t.set(null,e)}))))}return{has:e.has,get:n,set:u,splice:i,prev:e.prev,next:e.next,observe:e.observe}}}]),t}(l.ObservableList);n.MutableList=c,n["default"]=c},{"./observable_list":20}],16:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./key"),o=r(i),a=function l(){var e=this;u(this,l),this.observe=function(t){var n=o["default"].create();return e._observers[n]=t,{unsubscribe:function(){delete e._observers[n]}}},this.notify=function(t){for(var n in e._observers)t(e._observers[n])},this._observers=Object.create(null)};n.Subject=a},{"./key":12}],17:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./cache"),l=r(a),c=function(e){function t(e){var n=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.observe=function(e){return n._list.observe(e)},this.onInvalidate=function(e,t){var r;for(r=e;void 0!==(r=n._next[r])&&(delete n._next[n._prev[r]],delete n._prev[r],r!=t);)delete n._byKey[r];for(;void 0!==(r=n._prev[r])&&(delete n._prev[n._next[r]],delete n._next[r],r!=e);)delete n._byKey[r]},e.observe(this)}return i(t,e),t}(l["default"]);n.ObservableCache=c,n["default"]=c},{"./cache":9}],18:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./index"),l=r(a),c=e("./observable"),s=function(e){function t(e){var n=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.has=function(e){if(e>=0&&e<n._byIndex.length)return!0;for(var t,r=n._byIndex.length-1;r!=e;){if(t=n._list.next(n._byIndex[r]),null==t)return!1;n._byIndex[++r]=t,n._byKey[t]=r}return!0},this.observe=function(e){return n._subject.observe(e)},this.onInvalidate=function(e,t){for(var r=n._byKey[e],u=n._byIndex.length,i=r;++i<u;)delete n._byKey[n._byIndex[i]];n._byIndex.splice(r+1),n._subject.notify(function(e){e.onInvalidate(r,null)})},this._byKey=Object.create(null),this._subject=new c.Subject,e.observe(this)}return i(t,e),t}(l["default"]);n.ObservableIndex=s,n["default"]=s},{"./index":11,"./observable":16}],19:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./key_by"),l=r(a),c=e("./observable"),s=function(e){function t(e,n){var r=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n),this.observe=function(e){return r._subject.observe(e)},this.onInvalidate=function(e,t){r._subject.notify(function(n){n.onInvalidate(this._keyBySourceKey[e],this._keyBySourceKey[t])})},this._subject=new c.Subject,e.observe(this)}return i(t,e),t}(l["default"]);n.ObservableKeyBy=s,n["default"]=s},{"./key_by":13,"./observable":16}],20:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,
r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},l=e("./list"),c=e("./tree"),s=e("./observable"),f=e("./observable_cache"),v=r(f),y=e("./observable_index"),h=r(y),p=e("./observable_key_by"),d=r(p),b=function(e){function t(e){var n=this;u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.observe=function(e){throw new Error("Not implemented")},this.reverse=function(){return t.create(t.reverse(n))},this.map=function(e){return t.create(t.map(n,e))},this.filter=function(e){return t.create(t.filter(n,e))},this.flatten=function(){return t.create(t.flatten(n))},this.flatMap=function(e){return t.create(t.flatMap(n,e))},this.cache=function(){return t.create(t.cache(n))},this.index=function(){return t.create(t.index(n))},this.keyBy=function(e){return t.create(t.keyBy(n,e))},this.zip=function(e,r){return t.create(t.zip(n,e,r))},this.skip=function(e){return t.create(t.skip(n,e))},this.take=function(e){return t.create(t.take(n,e))},this.range=function(e,r){return t.create(t.range(n,e,r))},this.scan=function(e,r){return t.create(t.scan(n,e,r))},null!=e&&(this.observe=e.observe)}return i(t,e),o(t,null,[{key:"isObservableList",value:function(e){return l.List.isList(e)&&!!e.observe}},{key:"create",value:function(e){return new t({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe})}},{key:"reverse",value:function(e){function t(t){return e.observe({onInvalidate:function(e,n){t.onInvalidate(n,e)}})}var n=l.List.reverse(e),r=n.has,u=n.get,i=n.prev,o=n.next;return{has:r,get:u,prev:i,next:o,observe:t}}},{key:"map",value:function(e,t){var n=l.List.map(e,t),r=n.has,u=n.get,i=n.prev,o=n.next;return{has:r,get:u,prev:i,next:o,observe:e.observe}}},{key:"filter",value:function(e,t){function n(t){return e.observe({onInvalidate:function(e,n){e=u(e)?e:o(e),n=u(n)?n:a(n),t.onInvalidate(e,n)}})}var r=l.List.filter(e,t),u=r.has,i=r.get,o=r.prev,a=r.next;return{has:u,get:i,prev:o,next:a,observe:n}}},{key:"flatten",value:function(e){var n,r=Object.create(null),u=new s.Subject;e.observe({onInvalidate:function(e,t){var u;for(u=e;null!=(u=n.next(u))&&u!=t;){var i=r[u];i&&(i.unsubscribe(),delete r[u])}for(u=t;null!=(u=n.prev(u))&&u!=e;){var i=r[u];i&&(i.unsubscribe(),delete r[u])}}}),n=t.cache(t.map(e,function(t,n){return r[n]=t.observe({onInvalidate:function(t,r){var i,o,a=c.Path.append(n,t),l=c.Path.append(n,r);null==t&&(a=c.Tree.prev(e,c.Tree.next(e,a))),null==r&&(l=c.Tree.next(e,c.Tree.prev(e,l))),i=c.Path.key(a),o=c.Path.key(l),u.notify(function(e){e.onInvalidate(i,o)})}}),t})),n.observe({onInvalidate:function(t,n){var r=c.Path.key(c.Tree.prev(e,[t])),i=c.Path.key(c.Tree.next(e,[n]));u.notify(function(e){e.onInvalidate(r,i)})}});var i=l.List.flatten(n),o=i.has,a=i.get,f=i.next,v=i.prev;return{has:o,get:a,next:f,prev:v,observe:u.observe}}},{key:"flatMap",value:function(e,n){return t.flatten(t.map(e,n))}},{key:"cache",value:function(e){return new v["default"](e)}},{key:"index",value:function(e){return new h["default"](e)}},{key:"keyBy",value:function(e,t){return new d["default"](e,t)}},{key:"zip",value:function(e,n,r){function u(t){return e.has(t)&&n.has(t)}function i(t){return u(t)?r(e.get(t),n.get(t)):void 0}function o(t){var r=e.prev(t);return null!=r&&r==n.prev(t)?r:null}function a(t){var r=e.next(t);return null!=r&&r==n.next(t)?r:null}e=t.index(e),n=t.index(n);var l=new s.Subject,c={onInvalidate:function(e,t){l.notify(function(n){n.onInvalidate(e,t)})}};return e.observe(c),n.observe(c),{has:u,get:i,prev:o,next:a,observe:l.observe}}},{key:"skip",value:function(e,n){return t.filter(t.index(e),function(e,t){return t>=n})}},{key:"take",value:function(e,n){return t.filter(t.index(e),function(e,t){return n>t})}},{key:"range",value:function(e,n,r){return t.filter(t.index(e),function(e,t){return t>=n&&r+n>t})}},{key:"scan",value:function(e,n,r){function u(t){var u=o.prev(t);return n(null!=u?o.get(u):r,e.get(t))}function i(t){return e.observe({onInvalidate:function(e,n){t.onInvalidate(e,null)}})}var o,a=e.has,l=e.prev,c=e.next;return o=t.cache({has:a,get:u,prev:l,next:c,observe:i})}}]),t}(l.List);n.ObservableList=b,n["default"]=b},{"./list":14,"./observable":16,"./observable_cache":17,"./observable_index":18,"./observable_key_by":19,"./tree":21}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,u=e("./list");n.Path=r,function(e){function t(e){return JSON.stringify(e)}function n(e){return null==e?null:JSON.parse(e.toString())}function r(e){return e?e[0]:null}function u(e,t){return e[t]}function i(e){return null==e?[]:e.slice(1,e.length)}function o(e,t){return[].concat(e).concat(t)}e.key=t,e.create=n,e.head=r,e.get=u,e.tail=i,e.append=o}(r||(n.Path=r={}));var i;n.Tree=i,function(e){function t(t,n){var u=void 0===arguments[2]?1/0:arguments[2],i=r.head(n),o=r.tail(n);return t.has(i)&&(0==o.length||0==u||e.has(t.get(i),o,u))}function n(t,n){var u=void 0===arguments[2]?1/0:arguments[2],i=r.head(n),o=r.tail(n);if(t.has(i)){var a=t.get(i);return 0==o.length||0==u?a:e.get(a,o,u)}}function i(t){var n,i=void 0===arguments[1]?[]:arguments[1],o=void 0===arguments[2]?1/0:arguments[2],a=r.head(i),l=r.tail(i),c=a;if(null==a||t.has(a))do if(n=t.get(c),u.List.isList(n)&&0!=o){var s=e.prev(n,l,o-1);if(null!=s)return r.append(c,s);l=[]}else if(null!=c&&c!=a)return[c];while(null!=(c=t.prev(c)))}function o(t){var n,i=void 0===arguments[1]?[]:arguments[1],o=void 0===arguments[2]?1/0:arguments[2],a=r.head(i),l=r.tail(i),c=a;if(null==a||t.has(a))do if(n=t.get(c),u.List.isList(n)&&0!=o){var s=e.next(n,l,o-1);if(null!=s)return r.append(c,s);l=[]}else if(null!=c&&c!=a)return[c];while(null!=(c=t.next(c)))}e.has=t,e.get=n,e.prev=i,e.next=o}(i||(n.Tree=i={})),n["default"]=i},{"./list":14}],22:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./key"),l=r(a),c=e("./observable"),s=e("./mutable_list"),f=function(e){function t(e){var n=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.has=function(e){return n._key==e},this.get=function(e){return n.has(e)?n._value:void 0},this.prev=function(e){return null==e?n._key:null},this.next=function(e){return null==e?n._key:null},this.set=function(e,t){n._key=e,n._value=t,n._invalidate()},this.splice=function(e,t){for(var r=arguments.length,u=Array(r>2?r-2:0),i=2;r>i;i++)u[i-2]=arguments[i];return u.length?n.set(l["default"].create(),u[0]):(delete n._key,delete n._value,void n._invalidate())},this.observe=function(e){return n._subject.observe(e)},this._invalidate=function(e,t){n._subject.notify(function(n){n.onInvalidate(e,t)})},this._subject=new c.Subject,arguments.length&&this.splice(null,null,e)}return i(t,e),t}(s.MutableList);n["default"]=f,t.exports=n["default"]},{"./key":12,"./mutable_list":15,"./observable":16}],23:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n){var u=this;r(this,e),this.has=function(e){return new Promise(function(t,n){u._scheduler(function(){Promise.resolve(u._list.has(e)).then(t)["catch"](n)})})},this.get=function(e){return new Promise(function(t,n){u.has(e).then(function(r){return r?t(u._list.get(e)):n()})["catch"](n)})},this.prev=function(e){return new Promise(function(t,n){u._scheduler(function(){Promise.resolve(u._list.prev(e)).then(function(e){return null!=e?t(e):n()})["catch"](n)})})},this.next=function(e){return new Promise(function(t,n){u._scheduler(function(){Promise.resolve(u._list.next(e)).then(function(e){return null!=e?t(e):n()})["catch"](n)})})},this._list=t,this._scheduler=n||window.setTimeout}return u(e,null,[{key:"create",value:function(t){return new e(t)}},{key:"map",value:function(t,n){function r(e){return t.get(e).then(n)}var u=t.has,i=t.prev,o=t.next;return new e({has:u,get:r,prev:i,next:o})}}]),e}();n.AsyncList=i,n["default"]=i},{}],24:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function i(e){var t=this;r(this,i),this.has=function(e){return e in t._byKey||t._list.has(e)},this.get=function(e){return e in t._byKey?t._byKey[e]:t._list.has(e)?t._byKey[e]=t._list.get(e):void 0},this.prev=function(e){if(e in t._prev)return t._prev[e];var n=t._list.prev(e);return null==n&&(n=null),t._prev[e]=n,t._next[n]=e,n},this.next=function(){var e=void 0===arguments[0]?null:arguments[0];if(e in t._next)return t._next[e];var n=t._list.next(e);return null==n&&(n=null),t._next[e]=n,t._prev[n]=e,n},this._byKey=Object.create(null),this._next=Object.create(null),this._prev=Object.create(null),this._list=e};n.Cache=u,n["default"]=u},{}],25:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function i(e){var t=this;r(this,i),this.has=function(e){if(e>=0&&e<t._byIndex.length)return!0;for(var n,r=t._byIndex.length-1;r!=e;){if(n=t._list.next(t._byIndex[r]),null==n)return!1;t._byIndex[++r]=n}return!0},this.get=function(e){return t.has(e)?t._list.get(t._byIndex[e]):void 0},this.prev=function(e){return t.has(e-1)?e-1:null==e&&t._byIndex.length?t._byIndex.length-1:null},this.next=function(){var e=void 0===arguments[0]?-1:arguments[0];return t.has(e+1)?e+1:null},this._byIndex=[],this._list=e};n.Index=u,n["default"]=u},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r;!function(e){function t(e){return e.toString()}function n(){return r++}var r=0;e.key=t,e.create=n}(r||(r={})),n["default"]=r,t.exports=n["default"]},{}],27:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var u=function i(e,t){var n=this;r(this,i),this.has=function(e){if(e in n._sourceKeyByKey)return!0;for(var t=null;null!=(t=n.next(t));)if(t==e)return!0;return!1},this.get=function(e){return n.has(e)?n._list.get(n._sourceKeyByKey[e]):void 0},this.prev=function(e){return n.has(e)||null==e?n._keyBySourceKey[n._list.prev(n._sourceKeyByKey[e])]:void 0},this.next=function(){var e,t,r=void 0===arguments[0]?null:arguments[0];e=r in n._sourceKeyByKey?n._sourceKeyByKey[r]:null;for(;null!=r&&!(r in n._sourceKeyByKey);)if(e=n._list.next(e),!(e in n._keyBySourceKey)){if(null==e)return null;if(t=n._keyFn(n._list.get(e),e),n._keyBySourceKey[e]=t,n._sourceKeyByKey[t]=e,t==r)break}return e=n._list.next(e),null==e?null:(t=n._keyFn(n._list.get(e),e),n._keyBySourceKey[e]=t,n._sourceKeyByKey[t]=e,t)},this._list=e,this._keyFn=t,this._sourceKeyByKey=Object.create(null),this._keyBySourceKey=Object.create(null)};n.KeyBy=u,n["default"]=u},{}],28:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},l=e("./key"),c=r(l),s=e("./observable"),f=e("./mutable_list"),v=function(e){function t(e,n){var r=this;i(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this._keyFn=c["default"].create,this.has=function(e){return e in r._byKey},this.get=function(e){return r._byKey[e]},this.prev=function(){var e=void 0===arguments[0]?null:arguments[0],t=r._prev[e];return null==t?null:t},this.next=function(){var e=void 0===arguments[0]?null:arguments[0],t=r._next[e];return null==t?null:t},this.set=function(e,t){return r.has(e)?(r._byKey[e]=t,r._invalidate(r._prev[e],r._next[e]),e):null},this.splice=function(){for(var e=arguments.length,t=Array(e>2?e-2:0),n=2;e>n;n++)t[n-2]=arguments[n];var u,i,o=void 0===arguments[0]?null:arguments[0],a=void 0===arguments[1]?null:arguments[1];for(u=o;null!=(u=r._next[u])&&(delete r._next[r._prev[u]],delete r._prev[u],u!=a);)delete r._byKey[u];for(u=a;null!=(u=r._prev[u])&&(delete r._prev[r._next[u]],delete r._next[u],u!=o);)delete r._byKey[u];var l=o,c=!0,s=!1,f=void 0;try{for(var v,y=t[Symbol.iterator]();!(c=(v=y.next()).done);c=!0)i=v.value,u=r._keyFn(i),r._byKey[u]=i,r._prev[u]=l,r._next[l]=u,l=u}catch(h){s=!0,f=h}finally{try{!c&&y["return"]&&y["return"]()}finally{if(s)throw f}}r._prev[a]=l,r._next[l]=a,r._invalidate(o,a)},this.observe=function(e){return r._subject.observe(e)},this._invalidate=function(e,t){r.has(e)||(e=null),r.has(t)||(t=null),r._subject.notify(function(n){n.onInvalidate(e,t)})},n&&(this._keyFn=n),this._subject=new s.Subject,this._byKey=Object.create(null),this._prev=Object.create(null),this._next=Object.create(null),this._prev[null]=null,this._next[null]=null,this.splice.apply(this,[null,null].concat(u(e)))}return o(t,e),t}(f.MutableList);n["default"]=v,t.exports=n["default"]},{"./key":26,"./mutable_list":30,"./observable":31}],29:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("./tree"),a=e("./cache"),l=r(a),c=e("./index"),s=r(c),f=e("./key_by"),v=r(f),y=e("./async_list"),h=function(){function e(t){var n=this;u(this,e),this.has=function(e){throw new Error("Not implemented")},this.get=function(e){throw new Error("Not implemented")},this.prev=function(e){throw new Error("Not implemented")},this.next=function(e){throw new Error("Not implemented")},this.first=function(){return e.first(n)},this.last=function(){return e.last(n)},this.forEach=function(t){return e.forEach(n,t)},this.reduce=function(t,r){return e.reduce(n,t)},this.toArray=function(){return e.toArray(n)},this.findKey=function(t){return e.findKey(n,t)},this.find=function(t){return e.find(n,t)},this.keyOf=function(t){return e.keyOf(n,t)},this.indexOf=function(t){return e.indexOf(n,t)},this.keyAt=function(t){return e.keyAt(n,t)},this.at=function(t){return e.at(n,t)},this.every=function(t){return e.every(n,t)},this.some=function(t){return e.some(n,t)},this.contains=function(t){return e.contains(n,t)},this.reverse=function(){return e.create(e.reverse(n))},this.map=function(t){return e.create(e.map(n,t))},this.filter=function(t){return e.create(e.filter(n,t))},this.flatten=function(){return e.create(e.flatten(n))},this.flatMap=function(t){return e.create(e.flatMap(n,t))},this.cache=function(){return e.create(e.cache(n))},this.index=function(){return e.create(e.index(n))},this.keyBy=function(t){return e.create(e.keyBy(n,t))},this.zip=function(t,r){return e.create(e.zip(n,t,r))},this.skip=function(t){return e.create(e.skip(n,t))},this.take=function(t){return e.create(e.take(n,t))},this.range=function(t,r){return e.create(e.range(n,t,r))},this.scan=function(t,r){return e.create(e.scan(n,t,r))},null!=t&&(this.has=t.has,this.get=t.get,this.prev=t.prev,this.next=t.next)}return i(e,null,[{key:"isList",value:function(e){return!!(null!=e&&e.has&&e.get&&e.prev&&e.next)}},{key:"create",value:function(t){return new e({has:t.has,get:t.get,prev:t.prev,next:t.next})}},{key:"first",value:function(e){return e.get(e.next())}},{key:"last",value:function(e){return e.get(e.prev())}},{key:"forEach",value:function(e,t){for(var n;null!=(n=e.next(n));)t(e.get(n),n)}},{key:"reduce",value:function(e,t,n){for(var r;null!=(r=e.next(r));)n=t(n,e.get(r),r);return n}},{key:"toArray",value:function(e){for(var t,n=0,r=[];null!=(t=e.next(t));)r[n++]=e.get(t);return r}},{key:"findKey",value:function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return n}},{key:"find",value:function(t,n){return t.get(e.findKey(t,n))}},{key:"keyOf",value:function(t,n){return e.findKey(t,function(e){return e===n})}},{key:"indexOf",value:function(e,t){for(var n,r=0;null!=(n=e.next(n));){if(e.get(n)===t)return r;r++}}},{key:"keyAt",value:function(e,t){for(var n,r=0;null!=(n=e.next(n));)if(r++==t)return n;return null}},{key:"at",value:function(t,n){return t.get(e.keyAt(t,n))}},{key:"every",value:function(e,t){for(var n;null!=(n=e.next(n));)if(!t(e.get(n),n))return!1;return!0}},{key:"some",value:function(e,t){for(var n;null!=(n=e.next(n));)if(t(e.get(n),n))return!0;return!1}},{key:"contains",value:function(t,n){return e.some(t,function(e){return e===n})}},{key:"reverse",value:function(e){function t(t){return e.next(t)}function n(t){return e.prev(t)}var r=e.has,u=e.get;return{has:r,get:u,prev:t,next:n}}},{key:"map",value:function(e,t){function n(n){return r(n)?t(e.get(n),n):void 0}var r=e.has,u=e.prev,i=e.next;return{has:r,get:n,prev:u,next:i}}},{key:"filter",value:function(e,t){function n(n){return e.has(n)&&t(e.get(n),n)}function r(t){return n(t)?e.get(t):void 0}function u(t){for(var r=t;null!=(r=e.prev(r));)if(n(r))return r;return null}function i(t){for(var r=t;null!=(r=e.next(r));)if(n(r))return r;return null}return{has:n,get:r,prev:u,next:i}}},{key:"flatten",value:function(e){function t(t){var n=o.Path.create(t);return o.Tree.has(e,n,1)}function n(t){var n=o.Path.create(t);return o.Tree.get(e,n,1)}function r(t){var n=o.Path.create(t);return o.Path.key(o.Tree.prev(e,n,1))}function u(t){var n=o.Path.create(t);return o.Path.key(o.Tree.next(e,n,1))}return{has:t,get:n,prev:r,next:u}}},{key:"flatMap",value:function(t,n){return e.flatten(e.map(t,n))}},{key:"cache",value:function(e){return new l["default"](e)}},{key:"index",value:function(e){return new s["default"](e)}},{key:"keyBy",value:function(e,t){return new v["default"](e,t)}},{key:"zip",value:function(t,n,r){function u(e){return t.has(e)&&n.has(e)}function i(e){return u(e)?r(t.get(e),n.get(e)):void 0}function o(e){var r=t.prev(e);return null!=r&&r==n.prev(e)?r:null}function a(e){var r=t.next(e);return null!=r&&r==n.next(e)?r:null}return t=e.index(t),n=e.index(n),{has:u,get:i,prev:o,next:a}}},{key:"skip",value:function(t,n){return e.filter(e.index(t),function(e,t){return t>=n})}},{key:"take",value:function(t,n){return e.filter(e.index(t),function(e,t){return n>t})}},{key:"range",value:function(t,n,r){return e.filter(e.index(t),function(e,t){return t>=n&&r+n>t})}},{key:"scan",value:function(t,n,r){function u(e){var u=i.prev(e);return n(null!=u?i.get(u):r,t.get(e))}var i,o=t.has,a=t.prev,l=t.next;return i=e.cache({has:o,get:u,prev:a,next:l})}},{key:"async",value:function(e,t){return new y.AsyncList(e)}}]),e}();n.List=h,n["default"]=h},{"./async_list":23,"./cache":24,"./index":25,"./key_by":27,"./tree":36}],30:[function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},l=e("./observable_list"),c=function(e){function t(e){var n=this;u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.set=function(e,t){throw new Error("Not implemented")},this.splice=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),u=2;n>u;u++)r[u-2]=arguments[u];throw new Error("Not implemented")},this.addBefore=function(e,r){return t.addBefore(n,e,r)},this.addAfter=function(e,r){return t.addAfter(n,e,r)},this.push=function(e){return t.push(n,e)},this.unshift=function(e){return t.unshift(n,e)},this["delete"]=function(e){return t["delete"](n,e)},this.deleteBefore=function(e){return t.deleteBefore(n,e)},this.deleteAfter=function(e){return t.deleteAfter(n,e)},this.pop=function(){return t.pop(n)},this.shift=function(){return t.shift(n)},this.remove=function(e){return t.remove(n,e)},this.compose=function(e){return t.create(t.compose(n,e))},null!=e&&(this.set=e.set,this.splice=e.splice)}return i(t,e),o(t,null,[{key:"isMutableList",value:function(e){return l.ObservableList.isObservableList(e)&&!!e.set&&!!e.splice}},{key:"create",value:function(e){return new t({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe,set:e.set,splice:e.splice})}},{key:"addBefore",value:function(e,t,n){return e.splice(e.prev(t),t,n),e.prev(t)}},{key:"addAfter",value:function(e,t,n){return e.splice(t,e.next(t),n),e.next(t)}},{key:"push",value:function(e,n){return t.addBefore(e,null,n)}},{key:"unshift",value:function(e,n){return t.addAfter(e,null,n)}},{key:"delete",value:function(e,t){if(e.has(t)){var n=e.get(t);return e.splice(e.prev(t),e.next(t)),n}}},{key:"deleteBefore",value:function(e,n){return t["delete"](e,e.prev(n))}},{key:"deleteAfter",value:function(e,n){return t["delete"](e,e.next(n))}},{key:"pop",value:function(e){return t.deleteBefore(e,null)}},{key:"shift",value:function(e){return t.deleteAfter(e,null)}},{key:"remove",value:function(e,n){var r=t.keyOf(e,n);return null==r?!1:(delete r,!0)}},{key:"compose",value:function(e,t){function n(n){return t.get(e.get(n))}function u(n,r){e.set(n,t.set(e.get(n),r))}function i(n,u){for(var i=arguments.length,o=Array(i>2?i-2:0),a=2;i>a;a++)o[a-2]=arguments[a];e.splice.apply(e,[n,u].concat(r(o.map(function(e){return t.set(null,e)}))))}return{has:e.has,get:n,set:u,splice:i,prev:e.prev,next:e.next,observe:e.observe}}}]),t}(l.ObservableList);n.MutableList=c,n["default"]=c},{"./observable_list":35}],31:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("./key"),o=r(i),a=function l(){var e=this;u(this,l),this.observe=function(t){var n=o["default"].create();return e._observers[n]=t,{unsubscribe:function(){delete e._observers[n]}}},this.notify=function(t){for(var n in e._observers)t(e._observers[n])},this._observers=Object.create(null)};n.Subject=a},{"./key":26}],32:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./cache"),l=r(a),c=function(e){function t(e){var n=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.observe=function(e){return n._list.observe(e)},this.onInvalidate=function(e,t){var r;for(r=e;void 0!==(r=n._next[r])&&(delete n._next[n._prev[r]],delete n._prev[r],r!=t);)delete n._byKey[r];for(;void 0!==(r=n._prev[r])&&(delete n._prev[n._next[r]],delete n._next[r],r!=e);)delete n._byKey[r]},e.observe(this)}return i(t,e),t}(l["default"]);n.ObservableCache=c,n["default"]=c},{"./cache":24}],33:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./index"),l=r(a),c=e("./observable"),s=function(e){function t(e){var n=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.has=function(e){if(e>=0&&e<n._byIndex.length)return!0;for(var t,r=n._byIndex.length-1;r!=e;){if(t=n._list.next(n._byIndex[r]),null==t)return!1;n._byIndex[++r]=t,n._byKey[t]=r}return!0},this.observe=function(e){return n._subject.observe(e)},this.onInvalidate=function(e,t){for(var r=n._byKey[e],u=n._byIndex.length,i=r;++i<u;)delete n._byKey[n._byIndex[i]];n._byIndex.splice(r+1),n._subject.notify(function(e){e.onInvalidate(r,null)})},this._byKey=Object.create(null),this._subject=new c.Subject,e.observe(this)}return i(t,e),t}(l["default"]);n.ObservableIndex=s,n["default"]=s},{"./index":25,"./observable":31}],34:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},a=e("./key_by"),l=r(a),c=e("./observable"),s=function(e){function t(e,n){var r=this;u(this,t),o(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n),this.observe=function(e){return r._subject.observe(e)},this.onInvalidate=function(e,t){r._subject.notify(function(n){n.onInvalidate(this._keyBySourceKey[e],this._keyBySourceKey[t])})},this._subject=new c.Subject,e.observe(this)}return i(t,e),t}(l["default"]);n.ObservableKeyBy=s,n["default"]=s},{"./key_by":27,"./observable":31}],35:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function(e,t,n){for(var r=!0;r;){var u=e,i=t,o=n;a=c=l=void 0,r=!1;var a=Object.getOwnPropertyDescriptor(u,i);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(o)}var c=Object.getPrototypeOf(u);if(null===c)return void 0;e=c,t=i,n=o,r=!0}},l=e("./list"),c=e("./tree"),s=e("./observable"),f=e("./observable_cache"),v=r(f),y=e("./observable_index"),h=r(y),p=e("./observable_key_by"),d=r(p),b=function(e){function t(e){var n=this;u(this,t),a(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.observe=function(e){throw new Error("Not implemented")},this.reverse=function(){return t.create(t.reverse(n))},this.map=function(e){return t.create(t.map(n,e))},this.filter=function(e){return t.create(t.filter(n,e))},this.flatten=function(){return t.create(t.flatten(n))},this.flatMap=function(e){return t.create(t.flatMap(n,e))},this.cache=function(){return t.create(t.cache(n))},this.index=function(){return t.create(t.index(n))},this.keyBy=function(e){return t.create(t.keyBy(n,e))},this.zip=function(e,r){return t.create(t.zip(n,e,r))},this.skip=function(e){return t.create(t.skip(n,e))},this.take=function(e){return t.create(t.take(n,e))},this.range=function(e,r){return t.create(t.range(n,e,r))},this.scan=function(e,r){return t.create(t.scan(n,e,r))},null!=e&&(this.observe=e.observe)}return i(t,e),o(t,null,[{key:"isObservableList",value:function(e){return l.List.isList(e)&&!!e.observe}},{key:"create",value:function(e){return new t({has:e.has,get:e.get,prev:e.prev,next:e.next,observe:e.observe})}},{key:"reverse",value:function(e){function t(t){return e.observe({onInvalidate:function(e,n){t.onInvalidate(n,e)}})}var n=l.List.reverse(e),r=n.has,u=n.get,i=n.prev,o=n.next;return{has:r,get:u,prev:i,next:o,observe:t}}},{key:"map",value:function(e,t){var n=l.List.map(e,t),r=n.has,u=n.get,i=n.prev,o=n.next;return{has:r,get:u,prev:i,next:o,observe:e.observe}}},{key:"filter",value:function(e,t){function n(t){return e.observe({onInvalidate:function(e,n){e=u(e)?e:o(e),n=u(n)?n:a(n),t.onInvalidate(e,n)}})}var r=l.List.filter(e,t),u=r.has,i=r.get,o=r.prev,a=r.next;return{has:u,get:i,prev:o,next:a,observe:n}}},{key:"flatten",value:function(e){var n,r=Object.create(null),u=new s.Subject;e.observe({onInvalidate:function(e,t){var u;for(u=e;null!=(u=n.next(u))&&u!=t;){var i=r[u];i&&(i.unsubscribe(),delete r[u])}for(u=t;null!=(u=n.prev(u))&&u!=e;){var i=r[u];i&&(i.unsubscribe(),delete r[u])}}}),n=t.cache(t.map(e,function(t,n){return r[n]=t.observe({onInvalidate:function(t,r){var i,o,a=c.Path.append(n,t),l=c.Path.append(n,r);null==t&&(a=c.Tree.prev(e,c.Tree.next(e,a))),null==r&&(l=c.Tree.next(e,c.Tree.prev(e,l))),
i=c.Path.key(a),o=c.Path.key(l),u.notify(function(e){e.onInvalidate(i,o)})}}),t})),n.observe({onInvalidate:function(t,n){var r=c.Path.key(c.Tree.prev(e,[t])),i=c.Path.key(c.Tree.next(e,[n]));u.notify(function(e){e.onInvalidate(r,i)})}});var i=l.List.flatten(n),o=i.has,a=i.get,f=i.next,v=i.prev;return{has:o,get:a,next:f,prev:v,observe:u.observe}}},{key:"flatMap",value:function(e,n){return t.flatten(t.map(e,n))}},{key:"cache",value:function(e){return new v["default"](e)}},{key:"index",value:function(e){return new h["default"](e)}},{key:"keyBy",value:function(e,t){return new d["default"](e,t)}},{key:"zip",value:function(e,n,r){function u(t){return e.has(t)&&n.has(t)}function i(t){return u(t)?r(e.get(t),n.get(t)):void 0}function o(t){var r=e.prev(t);return null!=r&&r==n.prev(t)?r:null}function a(t){var r=e.next(t);return null!=r&&r==n.next(t)?r:null}e=t.index(e),n=t.index(n);var l=new s.Subject,c={onInvalidate:function(e,t){l.notify(function(n){n.onInvalidate(e,t)})}};return e.observe(c),n.observe(c),{has:u,get:i,prev:o,next:a,observe:l.observe}}},{key:"skip",value:function(e,n){return t.filter(t.index(e),function(e,t){return t>=n})}},{key:"take",value:function(e,n){return t.filter(t.index(e),function(e,t){return n>t})}},{key:"range",value:function(e,n,r){return t.filter(t.index(e),function(e,t){return t>=n&&r+n>t})}},{key:"scan",value:function(e,n,r){function u(t){var u=o.prev(t);return n(null!=u?o.get(u):r,e.get(t))}function i(t){return e.observe({onInvalidate:function(e,n){t.onInvalidate(e,null)}})}var o,a=e.has,l=e.prev,c=e.next;return o=t.cache({has:a,get:u,prev:l,next:c,observe:i})}}]),t}(l.List);n.ObservableList=b,n["default"]=b},{"./list":29,"./observable":31,"./observable_cache":32,"./observable_index":33,"./observable_key_by":34,"./tree":36}],36:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,u=e("./list");n.Path=r,function(e){function t(e){return JSON.stringify(e)}function n(e){return null==e?null:JSON.parse(e.toString())}function r(e){return e?e[0]:null}function u(e,t){return e[t]}function i(e){return null==e?[]:e.slice(1,e.length)}function o(e,t){return[].concat(e).concat(t)}e.key=t,e.create=n,e.head=r,e.get=u,e.tail=i,e.append=o}(r||(n.Path=r={}));var i;n.Tree=i,function(e){function t(t,n){var u=void 0===arguments[2]?1/0:arguments[2],i=r.head(n),o=r.tail(n);return t.has(i)&&(0==o.length||0==u||e.has(t.get(i),o,u))}function n(t,n){var u=void 0===arguments[2]?1/0:arguments[2],i=r.head(n),o=r.tail(n);if(t.has(i)){var a=t.get(i);return 0==o.length||0==u?a:e.get(a,o,u)}}function i(t){var n,i=void 0===arguments[1]?[]:arguments[1],o=void 0===arguments[2]?1/0:arguments[2],a=r.head(i),l=r.tail(i),c=a;if(null==a||t.has(a))do if(n=t.get(c),u.List.isList(n)&&0!=o){var s=e.prev(n,l,o-1);if(null!=s)return r.append(c,s);l=[]}else if(null!=c&&c!=a)return[c];while(null!=(c=t.prev(c)))}function o(t){var n,i=void 0===arguments[1]?[]:arguments[1],o=void 0===arguments[2]?1/0:arguments[2],a=r.head(i),l=r.tail(i),c=a;if(null==a||t.has(a))do if(n=t.get(c),u.List.isList(n)&&0!=o){var s=e.next(n,l,o-1);if(null!=s)return r.append(c,s);l=[]}else if(null!=c&&c!=a)return[c];while(null!=(c=t.next(c)))}e.has=t,e.get=n,e.prev=i,e.next=o}(i||(n.Tree=i={})),n["default"]=i},{"./list":29}]},{},[2])(2)});